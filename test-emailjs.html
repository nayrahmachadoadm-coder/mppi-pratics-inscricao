<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste EmailJS</title>
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        .test-section {
            margin: 20px 0;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #0056b3;
        }
        .result {
            margin-top: 10px;
            padding: 10px;
            border-radius: 4px;
        }
        .success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
    </style>
</head>
<body>
    <h1>üß™ Teste de Configura√ß√£o EmailJS</h1>
    
    <div class="test-section">
        <h2>1. Verificar Configura√ß√£o</h2>
        <p>Primeiro, vamos verificar se as configura√ß√µes est√£o carregadas corretamente:</p>
        <button onclick="verificarConfig()">Verificar Configura√ß√£o</button>
        <div id="config-result" class="result" style="display: none;"></div>
    </div>

    <div class="test-section">
        <h2>2. Testar Inicializa√ß√£o EmailJS</h2>
        <p>Vamos testar se conseguimos inicializar o EmailJS com a Public Key:</p>
        <button onclick="testarInicializacao()">Testar Inicializa√ß√£o</button>
        <div id="init-result" class="result" style="display: none;"></div>
    </div>

    <div class="test-section">
        <h2>3. Enviar Email de Teste</h2>
        <p>Se a inicializa√ß√£o funcionar, vamos tentar enviar um email de teste:</p>
        <button onclick="enviarEmailTeste()">Enviar Email de Teste</button>
        <div id="email-result" class="result" style="display: none;"></div>
    </div>

    <script>
        // Importar configura√ß√µes do EmailJS
        const EMAIL_CONFIG = {
            SERVICE_ID: 'service_7wgbrkh',
            TEMPLATE_ID: 'template_6zi9h8j',
            PUBLIC_KEY: 'KhlLBUAUHTe84YtRp',
            CC_EMAIL: 'planejamento@mppi.mp.br'
        };

        function mostrarResultado(elementId, tipo, mensagem) {
            const element = document.getElementById(elementId);
            element.className = `result ${tipo}`;
            element.innerHTML = mensagem;
            element.style.display = 'block';
        }

        function verificarConfig() {
            console.log('üîç Verificando configura√ß√£o...');
            
            let resultado = '<h3>Configura√ß√£o Atual:</h3>';
            resultado += `<strong>SERVICE_ID:</strong> ${EMAIL_CONFIG.SERVICE_ID}<br>`;
            resultado += `<strong>TEMPLATE_ID:</strong> ${EMAIL_CONFIG.TEMPLATE_ID}<br>`;
            resultado += `<strong>PUBLIC_KEY:</strong> ${EMAIL_CONFIG.PUBLIC_KEY}<br>`;
            resultado += `<strong>CC_EMAIL:</strong> ${EMAIL_CONFIG.CC_EMAIL}<br><br>`;
            
            // Verificar se os valores n√£o s√£o placeholders
            const temPlaceholders = 
                EMAIL_CONFIG.SERVICE_ID.includes('SEU_') ||
                EMAIL_CONFIG.TEMPLATE_ID.includes('SEU_') ||
                EMAIL_CONFIG.PUBLIC_KEY.includes('SUA_');
            
            if (temPlaceholders) {
                resultado += '<span style="color: red;">‚ùå Ainda h√° placeholders na configura√ß√£o!</span>';
                mostrarResultado('config-result', 'error', resultado);
            } else {
                resultado += '<span style="color: green;">‚úÖ Configura√ß√£o parece estar preenchida!</span>';
                mostrarResultado('config-result', 'success', resultado);
            }
        }

        function testarInicializacao() {
            console.log('üöÄ Testando inicializa√ß√£o...');
            
            try {
                // Tentar inicializar o EmailJS
                emailjs.init(EMAIL_CONFIG.PUBLIC_KEY);
                
                mostrarResultado('init-result', 'success', 
                    '‚úÖ EmailJS inicializado com sucesso!<br>' +
                    'A Public Key parece estar v√°lida.'
                );
            } catch (error) {
                console.error('Erro na inicializa√ß√£o:', error);
                mostrarResultado('init-result', 'error', 
                    `‚ùå Erro na inicializa√ß√£o:<br>${error.message}`
                );
            }
        }

        async function enviarEmailTeste() {
            console.log('üìß Enviando email de teste...');
            
            try {
                // Inicializar primeiro
                emailjs.init(EMAIL_CONFIG.PUBLIC_KEY);
                
                // Dados de teste
                const templateParams = {
                    to_name: 'Teste',
                    subject: 'Teste de Configura√ß√£o EmailJS',
                    message: 'Este √© um email de teste para verificar se a configura√ß√£o est√° funcionando.',
                    nome_completo: 'Usu√°rio de Teste',
                    email_institucional: 'teste@mppi.mp.br',
                    titulo_iniciativa: 'Teste de Configura√ß√£o',
                    inscricao_id: 'TEST-001'
                };

                mostrarResultado('email-result', 'info', '‚è≥ Enviando email de teste...');

                const response = await emailjs.send(
                    EMAIL_CONFIG.SERVICE_ID,
                    EMAIL_CONFIG.TEMPLATE_ID,
                    templateParams
                );

                console.log('‚úÖ Email enviado:', response);
                mostrarResultado('email-result', 'success', 
                    `‚úÖ Email de teste enviado com sucesso!<br>` +
                    `Status: ${response.status}<br>` +
                    `Text: ${response.text}`
                );

            } catch (error) {
                console.error('‚ùå Erro ao enviar email:', error);
                mostrarResultado('email-result', 'error', 
                    `‚ùå Erro ao enviar email de teste:<br>` +
                    `Status: ${error.status || 'N/A'}<br>` +
                    `Mensagem: ${error.text || error.message || 'Erro desconhecido'}<br><br>` +
                    `<strong>Poss√≠veis solu√ß√µes:</strong><br>` +
                    `‚Ä¢ Verificar se a Public Key est√° correta<br>` +
                    `‚Ä¢ Verificar se o SERVICE_ID existe<br>` +
                    `‚Ä¢ Verificar se o TEMPLATE_ID existe<br>` +
                    `‚Ä¢ Verificar se o template tem as vari√°veis corretas`
                );
            }
        }

        // Verificar configura√ß√£o automaticamente ao carregar
        window.onload = function() {
            verificarConfig();
        };
    </script>
</body>
</html>